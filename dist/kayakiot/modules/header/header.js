!function(){var a,b,c,d,e,f,g,h,i,j;c={CONTAINER_CLS:"J_Header"},a={classname:"kayakiot-header",jView:null,init:function(){b.init(),b.render(),b.bind()}},b={userCallback:function(c){var d=c.data;a.jView.find(".J_username").attr({master:d.master,"data-id":d.id}).text(d.realname),b.render(d)},init:function(){a.jView=d.get(a.classname,$("."+c.CONTAINER_CLS)),this.getInfo(this.userCallback)},render:function(b){var c=a.jView;c.kInsert(),b&&a.jView.find(".J_username").attr({master:b.master,"data-id":b.id}).text(b.realname)},bind:function(){var c=a.jView;a.hasBind||(c.on("click",function(a){var c=$(a.target);switch(!0){case b.isIn(c,"J_back_out"):b.backOut(c),$(".user_drop").click();break;case b.isIn(c,"user_drop"):$(".user_dropcont").toggle()}}),$("body").on("click",function(a){var b=$(a.target);switch(!0){case!b.hasClass("user_dropcont")&&!b.parents(".user_dropcont").length>0&&!b.hasClass("user_drop")&&!b.parents(".user_drop").length>0:$(".user_dropcont").hide()}}),a.hasBind=!0)},backOut:function(a){var b=window.location.href,c={userId:$(".J_username").data("id"),returnUrl:b};i.show(),g.post(j.loginOut,c,function(a){if(i.hide(),a.code+""!="0000"){var b={msg:a.result,btns:{ok:{text:"知道了",click:function(){}}}};return void h.show(b)}a.code+""=="0000"&&f.go("#full/kayakiot/login")})},isIn:function(a,b){return!!(a.hasClass(b)||a.parents("."+b).length>0)},getInfo:function(a){var b=j.getUserInfo;i.show(),g.post(b,{},function(b){if(i.hide(),b.code+""!="0000"){var c={title:"",msg:b.result,html:"",btns:{ok:{text:"知道了",click:function(){}}},onClickMask:function(){}};return void h.show(c)}b.code+""=="0000"&&"function"==typeof a&&a(b)})}},define("kayakiot/modules/header/header",function(require,b,c){require("kayakiot/modules/header/header.css"),require("kayakiot/modules/header/header.tpl"),h=cabin.widgets.pop,i=cabin.widgets.loading,g=require("kayakiot/common/data/ajax"),j=require("kayakiot/config/apimix"),f=kayak.router,d=kayak.dom,e="ontouchend"in document?"touchstart":"click",c.exports=a})}();